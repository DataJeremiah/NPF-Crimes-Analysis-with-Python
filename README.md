# NPF-Crimes-Analysis-with-Python

**Abstract**
This report examines the distinct types of crimes that occurred and their changes over the years. Utilizing open police data sources, the analysis covered recorded crime data delivered in a yearly format. It explores the geographical distribution of crime types and compares the changes during and after the COVID-19 pandemic. The analysis, implemented using Apache Spark core, assesses crime density and the impact of lockdown measures, providing a benchmark of crime types in the region during the specified period.

**INTRODUCTION **
This report delves into an analysis of crimes reported within the Nottinghamshire Police Force from March 2019 to March 2021. Utilizing open data sourced from data.police.uk, the study focuses on identifying distinct crime types and tracking changes over the specified period. The data encompasses monthly records in CSV format, detailing crime occurrences with specific fields such as Crime Type, Location, Post Code, Latitude, and Longitude. With the advent of the COVID-19 pandemic, Nottinghamshire implemented new health protocols to mitigate the virus's spread, including lockdowns, self-isolation, and social distancing measures. These changes significantly impacted crime rates, leading to noticeable shifts in both domestic and non-domestic crime reports. By leveraging Apache Spark core, the analysis provides insights into crime density, geographical distribution, and the effects of pandemic-induced lockdown measures. The report aims to benchmark crime types before, during, and after the pandemic, highlighting patterns and anomalies in the data. This study is crucial for understanding how public health crises and associated restrictions can influence criminal activity, providing valuable information for future policy and law enforcement strategies in the region.

**Data Set**
The dataset for this report was extracted from the open dataset source on data.police.uk for the years 2019, 2020, and 2021. This data, made available by the police, serves as a central collection point for recorded crime information. It was downloaded in monthly CSV files, covering the period from March 2019 to March 2021. The onset of the COVID-19 pandemic brought about new health protocols in Nottinghamshire, including lockdowns, self-isolation, and social distancing measures aimed at curbing the virus's spread. These measures led to significant changes in crime rates, with both domestic and non-domestic crimes showing notable variations. Each CSV file includes detailed fields such as Crime Type, Location, Post Code, Latitude, and Longitude, enabling a comprehensive geographical visualization of crime incidents. Nottinghamshire, located in the East Midlands region of England, comprises eight districts under the jurisdiction of the Nottinghamshire Police Force. The dataset's geographical coordinates provide a clear depiction of crime distribution and types across these districts during the specified period. The report analyzes these changes, noting variations in crime types and their frequencies across different months, thus offering a thorough understanding of the impact of the pandemic on crime in the region.

**Data Column Field**
Crime ID| Month| Reported by| Falls Within| Longitude | Latitude| Location | LSOA Code |  LSOA Name | Crime Type | Last Outcome  Category | Context

**METHODOLOGY - DATA PREPARATION**
The dataset was downloaded from the Police open source data. The files downloaded in monthly folder formats, 25 csv files for the 2 year period March 2019 – March 2021.Each of these files contained on average 11,000 records, which amounted to a total of 285,517 records. The project made use of analytical tools such as Apache Spark Core (Python 3) PySpark. The required folders were uploaded unto the Jupyter interface and into HDFS using the Web Console. In Jupyter a new phyton 3 session was created, and the required configuration were imported. To upload numerous files into a data frame and analyse the city of Nottinghamshire police crime data, a new data frame named "nottingham_dfCrime2" was created. The first option, "header," was set using the spark read option. it only indicates that each file is selecting a header row, setting the delimiter values and separating them with a comma "," and choosing the infer schema option.

**DATA CLEANING **
The project takes a deep dive into the data by looking at rows, columns, and missing values. A Loop was done to look for missing rows. Code for loop was set from 0 to loop through. i = 0 reset counter. We retrieve the total amount crime data for Nottinghamshire police. For the data frame we do a count from the first item is null where its equal true. Nottinghamshire crime count, Total records (285,517), Total columns (12) and Missing Values were“Crime_ID IS NULL” (82,038).

**Explatatory Data Analysis**
Now we have all our data in the data frame we can begin to count per year/month andstart to analyze the data structure. Count per month The data is arranged in a descending order. The highest crime rate per month is July 2019. In 2020 during the lockdown period, the crime rate were reported in May 2020 and July 2020 were high. Count per year The data retrieved showed 2020 and 2019 to be high, these before and after covid-19 pandemic. 2021 has only 3 months and not a full year and can only be compared by month. A new data frame was created to register as a temp table to report the monthly total and average of crime amount The new data frame contents are the crime amount per month in the period. Register temp table to show the average amount of crime reported per month and the highest is July, November and January.

**DATA ANALYSIS - DATA CRIME RATE**
In order to execute some SQL queries, declare the monthly crime total as a table. I set up the variables for visualisations in two steps: one involves using coding to accomplish some visualisation and the other involves importing Pixie Dust. A month was chosen by the report based on the monthly crime total.A registered table that includes the month, total amount, and average is used to calculate the monthly crime amount for each month. We import the required libraries and plot some data to visualise the overall average. To choose the month array for the monthly crime amount, use the code below. Month array versus total array is plotted by the variables.

I create a data frame to retrieve the data by year, it retrieves the total, year ,total and average. I register the data frame to run more queries on it.The yearly crime amount from year is a registered table and it’s used for plotting the variables and import the required libraries.The average count yearly we notice 2019 being high than 2020 but the cumulative 2020 is higher than 2019. The introduction of the lockdown saw many companies, business institution closed which left offices vulnerable for all types of attack, people being asked to stay home with offensive partners or not taking responsibility of public health. These resulted to high crime rate from anti-social behavior to violence and sexual offenses. They were increases in the proportion of cases closed without a court disposal. The median day crime rate was 33days in March 2020 to 43 days in March 2021. Sexual offences were highest by 53 days to 286. The total count of crime across the months which showed the month of May 2020 the highest in crime rate compared to December 2020. We cannot compare the crime amount for 2021 because its only 3 months. Nottinghamshire Police closed just a third of its cases with no suspect identified. The most common location of crime was near a supermarket, with increase in crime like shoplifting. The number of recorded crimes increased during the lockdown by 7% and post lockdown so a significant decrease in crime by 18%. Across the whole year ending 
year to March 2021, there was a 13% fall in total crime cases excluding fraud. The 12 reductions were driven by falls in covetous crimes such as theft of and from vehicle offences and burglary. The rate was mostly marked in the month of May 2020 compared with December 2020. The average monthly crime shows in the years witness
an increase in the month of July with a total count of 25,654 and average count of 12,827.0 This shows a very proactive strategy the Nottinghamshire Police force have put in place policy and procedures to work on all the crimes reported and see changes on the street. The is a very good improvement and great highlight from the study.

**DATA CRIME TYPE**
The report detailed analysis of the different data crime type per month and year. The result retrieved showed high crime rate in the month of September 2020 resulting to 3,773 counts of anti-social behavioral crime. Violence and sexual offences were high January 2021 with count of 2,438. Nottinghamshire Police can focus its recourses on crimes like violence and sexual offences to help reduce the crime. The figure below shows proportion of each crime reported in Nottinghamshire as 3 types of crime type accounted for 50 percent of all reported crime examples are violence and sexual offences, anti-social behavior and criminal damage.The highlighted months show very high crime rate with different crime type. The report showed Bicycle Theft is very low, Violence and Sexual Offences were very high in the month of September 2020, Other crime and Other Theft were high in July 2019 and Anti-Social Behavior in January 2021.The Nottinghamshire police can dispatch more resources on domestic crimes to see this reduced and collaborate with NGOs in creating a community root initiative. A clear message that “street harassment is not okay”. The common crime type across the period remains Anti-social behavior,Violence, and Sexual Offences. Crime types such as Criminal Damage and Arson, Shoplifting remains the same and Robbery and theft from person is very low. The illustration report show 2020 to be the highest in crime rate reported with two major crime type

**DATA VISUALISATION **
**GEOGRAPHY ANALYSIS**
Introducing Pixie Dust to show the pictorial representation of the analysis. We dive deep into the record to report geographical analysis, visualize the data crime type and crime count and follow trend. The highest percentage of crime type is Anti-social behavior with 29% and Voice and sexual offences with 26%, Criminal damage and arson 8%,shoplifting 7%. The report checks the crime count across years. the percentage of crime rate reported in 2019 and 2020 happen to share over 41%, 48% and 2021 which is 3 months 11%.

**CONCLUSION AND RECOMMENDATIONS**

The reported crime type highlighted the point of a high number of crimes as Anti-social behavior, Violence and sexual offences and Other Theft. The report marked increase in crime type per year following the Covid-19 outbreak and after lockdown. The analysis reported only for 2019,2020 and 2021.The number of crime type fluctuate over greater time with year making it a seasonal trend. The increase in crime rate in 2020 by 48% show of great highlight in the study. UK government imposing the lockdown measure, noticed a spike in crime type and common crimes seem to change. The recorded crime type is geographically distinct from reported crime fluctuates over time and have some categories of crime type. The report uncovered many flaws preserving missing values. With Anti-social behavior being the leading crime type. The report suggests further study to understand the situational context of these crimes be it domestic. I recommend further research of more years to see what policies and procedures have been taken to reduce crime rate










